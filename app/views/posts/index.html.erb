<h1 class="header">
  Instalink
  <%= link_to recent_chats_path, style: 'float: right; margin-left: 10px;' do %>
    <%= image_tag 'chat.png', alt: 'Chat', size: "30x30", style: 'vertical-align: middle;' %>
  <% end %>
  <%= link_to notifications_path, style: 'float: right; margin-left: 10px;' do %>
    <%= image_tag 'notification.png', alt: 'Notifications', size: "30x30", style: 'vertical-align: middle;' %>
  <% end %>
</h1>

<% @posts.each do |post| %>
  <div class="post-card">
    <div style="display: flex; align-items: center; justify-content: space-between; padding: 10px;">
      <div style="display: flex; align-items: center;">
        <% if post.user.profile_picture.attached? %>
          <%= image_tag post.user.profile_picture, size: "40x40", style: "border-radius: 50%; margin-right: 10px;" %>
        <% else %>
          <%= image_tag "profile_picture_default.jpeg", size: "40x40", style: "border-radius: 50%; margin-right: 10px;" %>
        <% end %>
        <div>
          <h4 style="margin: 0; font-size: 24px;">
            <%= link_to post.user.username, user_path(post.user), style: "text-decoration: none; color: inherit;" %>
          </h4>
          <% if post.location.present? %>
            <p style="margin: 0; font-size: 12px; color: gray;">
              <%= link_to post.location, posts_path(location: post.location), style: "text-decoration: none; color: inherit;" %>
            </p>
          <% end %>
        </div>
      </div>
      <% if post.user == current_user %>
        <div style="display: flex; gap: -5px; align-items: center;">
          <%= link_to 'Edit', edit_post_path(post), style: "text-decoration: none; font-size: 16px; color: blue;" %>
          <%= button_to 'Delete', post_path(post), method: :delete, data: { confirm: "Are you sure you want to delete this post?" }, style: "font-size: 16px; color: red; background: none; border: none; text-decoration: none; cursor: pointer;" %>
        </div>
      <% end %>
    </div>

    <% if post.images.attached? %>
      <div style="display: flex; flex-wrap: wrap; justify-content: center; align-items: center;">
        <% post.images.each do |image| %>
          <%= image_tag image, size: "300x300", style: "margin: 10px;" %>
        <% end %>
      </div>
    <% else %>
      <p style="text-align: center; font-size: 18px; color: gray;">No images attached.</p>
    <% end %>
    <div style="padding: 10px;">
      <div class="comments-section">
        <%= link_to image_tag('comment.png', size: "16x16", alt: "Comments", class: "comment-icon"), post_path(post) %>
      </div>
      <div style="font-size: 12px; color: gray; margin-bottom: 5px;">
        <p style="margin: 0;">
          <b style="font-size: 12px; color: inherit;"><%= post.user.username %>:</b> 
          <span style="font-size: 12px; color: inherit;"><%= post.content %></span>
        </p>
      </div>
      <p style="font-size: 12px; color: gray; margin: 0;">
        <%= time_ago_in_words(post.created_at) %> ago
      </p>
    </div>
  </div>
<% end %>

<%= link_to 'New Post', new_post_path, class: 'new-post-button' %>

<% if current_user %>
  <div class="user-icon">
    <%= link_to image_tag('user_icon.png', alt: 'User Icon', class: 'icon'), user_path(current_user) %>
  </div>
<% end %>

<div class="search-section">
  <%= form_with url: search_users_path, method: :get, local: true, class: 'search-form' do %>
    <%= text_field_tag :query, params[:query], placeholder: "Search users...", class: 'search-input' %>
    <%= submit_tag "Search", class: 'search-button' %>
  <% end %>
</div>
